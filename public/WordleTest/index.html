<!DOCTYPE html>
<html>
<head>
  <title>Word Guesser</title>
  <meta name="viewport" content="width=device-width, initial-scale=0.75, user-scalable=no">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    #hidden-input {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      height: 40px;
      opacity: 0;
      z-index: 100;
      font-size: 16px; /* Prevent zoom on iOS */
    }

    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      background-color: #fafafa;
      color: #1a1a1b !important;
      padding: 10px;
    }

    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      width: 100%;
      max-width: 500px;
      text-align: center;
      margin-bottom: 10px;
    }

    .title {
      font-size: 2rem;
      font-weight: 700;
      letter-spacing: 0.2rem;
      margin-bottom: 5px;
      color: #1a1a1b !important;
      text-transform: uppercase;
    }

    .subtitle {
      font-size: 0.9rem;
      color: #787c7e;
      margin-bottom: 15px;
      font-weight: 500;
    }

    .game-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 350px;
      background-color: white;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 10px;
    }

    .board {
      display: grid;
      grid-template-rows: repeat(6, 1fr);
      grid-gap: 6px;
      margin-bottom: 24px;
      width: 100%;
    }

    .row {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      grid-gap: 6px;
      width: 100%;
    }

    .tile {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      aspect-ratio: 1;
      border: 2px solid #d3d6da;
      border-radius: 4px;
      font-size: 2rem;
      font-weight: bold;
      text-transform: uppercase;
      transition: all 0.2s;
    }

    .tile.active {
      border-color: #878a8c;
      border-width: 2px;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 100% { border-color: #878a8c; }
      50% { border-color: #d3d6da; }
    }

    .correct {
      background-color: #6aaa64;
      color: white;
      border-color: #6aaa64;
      transform: rotateX(360deg);
      transition: transform 0.6s;
    }

    .present {
      background-color: #c9b458;
      color: white;
      border-color: #c9b458;
      transform: rotateX(360deg);
      transition: transform 0.6s;
    }

    .absent {
      background-color: #787c7e;
      color: white;
      border-color: #787c7e;
      transform: rotateX(360deg);
      transition: transform 0.6s;
    }

    .message {
      margin: 16px 0;
      font-weight: bold;
      min-height: 28px;
      text-align: center;
      font-size: 1.2rem;
      color: #1a1a1b !important;
    }

    .status {
      margin-top: 10px;
      text-align: center;
      font-size: 1rem;
      color: #787c7e;
      font-weight: 500;
    }

    .instructions {
      margin-top: 10px;
      text-align: center;
      max-width: 400px;
      padding: 15px;
      font-size: 0.9rem;
      line-height: 1.5;
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .instructions p {
      margin-bottom: 12px;
    }

    .instructions p:last-child {
      margin-bottom: 0;
    }

    .color-example {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-top: 16px;
    }

    .example-tile {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      display: inline-block;
      margin-right: 8px;
      vertical-align: middle;
    }

    .example-text {
      display: flex;
      align-items: center;
      font-size: 0.9rem;
    }

    .mode-indicator {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 12px;
      background-color: #e6e6e6;
      color: #1a1a1b !important;
      font-size: 0.8rem;
      font-weight: bold;
      margin-left: 8px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .mode-indicator:hover {
      background-color: #d0d0d0;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 100;
    }

    .modal-content {
      background-color: white;
      padding: 30px;
      border-radius: 12px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .modal-title {
      font-size: 1.5rem;
      margin-bottom: 15px;
      font-weight: bold;
    }

    .modal-text {
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .button-container {
      display: flex;
      gap: 10px;
      justify-content: center;
    }

    .button {
      background-color: #6aaa64;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 30px;
      font-weight: bold;
      cursor: pointer;
      font-size: 1rem;
      margin-top: 15px;
      transition: background-color 0.2s;
    }

    .button:hover {
      background-color: #5c9658;
    }

    .button.secondary {
      background-color: #787c7e;
    }

    .button.secondary:hover {
      background-color: #666;
    }

    @media (max-width: 768px) {
      .game-container {
        margin-bottom: 10px;
      }

      .instructions {
        margin-bottom: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">Word Guesser</div>
    <div class="subtitle">
      <span id="mode-text">Daily Challenge</span>
      <span class="mode-indicator" id="mode-indicator">DAILY</span>
    </div>
    <div class="game-container">
      <div class="board" id="board"></div>
      <div class="message" id="message"></div>
      <div class="status" id="status"></div>
    </div>

    <input type="text" id="hidden-input" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" inputmode="text">

    <div class="instructions">
      <p>Guess the WORD in 6 tries.</p>
      <p>Each guess must be a valid 5-letter word. Use your phone's keyboard to type and press enter to submit.</p>
      <p>After each guess, the color of the tiles will change to show how close your guess was to the word.</p>

      <div class="color-example">
        <div class="example-text">
          <span class="example-tile" style="background-color: #6aaa64;"></span>
          Correct
        </div>
        <div class="example-text">
          <span class="example-tile" style="background-color: #c9b458;"></span>
          Present
        </div>
        <div class="example-text">
          <span class="example-tile" style="background-color: #787c7e;"></span>
          Absent
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="win-modal">
    <div class="modal-content">
      <div class="modal-title">Congratulations!</div>
      <div class="modal-text" id="win-message">
        You've completed today's daily word!
        Would you like to continue playing with random words?
      </div>
      <div class="button-container">
        <button class="button" id="continue-button">Continue with Random Words</button>
        <button class="button secondary" id="play-again-button" style="display: none;">Play Again</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    // Include a subset of words for the standalone version
    const words = ["ABOUT"];

    let currentRow = 0;
    let currentTile = 0;
    let gameOver = false;
    let dailyMode = true;
    let word = '';

    function initializeBoard() {
      const board = document.getElementById('board');
      board.innerHTML = '';
      for (let i = 0; i < 6; i++) {
        const row = document.createElement('div');
        row.className = 'row';
        for (let j = 0; j < 5; j++) {
          const tile = document.createElement('div');
          tile.className = 'tile';
          row.appendChild(tile);
        }
        board.appendChild(row);
      }
      updateActiveTile();
      focusInput();
    }

    function focusInput() {
      const hiddenInput = document.getElementById('hidden-input');
      hiddenInput.focus();
      // Scroll to prevent visual keyboard from covering the game board
      window.scrollTo(0, 0);
    }

    function updateActiveTile() {
      const tiles = document.querySelectorAll('.tile');
      tiles.forEach(tile => tile.classList.remove('active'));
      if (currentRow < 6 && currentTile < 5) {
        tiles[currentRow * 5 + currentTile].classList.add('active');
      }
    }

    function handleKeyPress(key) {
      if (gameOver) return;

      if (/^[A-Za-z]$/.test(key)) {
        if (currentTile < 5) {
          const tiles = document.querySelectorAll('.tile');
          tiles[currentRow * 5 + currentTile].textContent = key.toUpperCase();
          currentTile++;
          updateActiveTile();
        }
      } else if (key === 'Backspace' && currentTile > 0) {
        currentTile--;
        const tiles = document.querySelectorAll('.tile');
        tiles[currentRow * 5 + currentTile].textContent = '';
        updateActiveTile();
      } else if (key === 'Enter' && currentTile === 5) {
        submitGuess();
      }
    }

    function submitGuess() {
      const row = document.querySelector(`.row:nth-child(${currentRow + 1})`);
      const tiles = row.querySelectorAll('.tile');
      const guess = Array.from(tiles).map(tile => tile.textContent).join('');

      if (!words.includes(guess)) {
        showMessage('Not in word list');
        return;
      }

      const result = checkGuess(guess);
      animateResult(result, tiles);

      if (result.every(r => r === 'correct')) {
        gameOver = true;
        confetti({
          particleCount: 100,
          spread: 70,
          origin: { y: 0.6 }
        });
        setTimeout(() => {
          showWinModal();
        }, 1500);
      } else if (currentRow === 5) {
        gameOver = true;
        showMessage(`Game Over! The word was ${word}`);
      } else {
        currentRow++;
        currentTile = 0;
        updateActiveTile();
      }
    }

    function checkGuess(guess) {
      const result = Array(5).fill('absent');
      const letterCount = {};

      for (let letter of word) {
        letterCount[letter] = (letterCount[letter] || 0) + 1;
      }

      for (let i = 0; i < 5; i++) {
        if (guess[i] === word[i]) {
          result[i] = 'correct';
          letterCount[guess[i]]--;
        }
      }

      for (let i = 0; i < 5; i++) {
        if (result[i] !== 'correct' && letterCount[guess[i]] > 0) {
          result[i] = 'present';
          letterCount[guess[i]]--;
        }
      }

      return result;
    }

    function animateResult(result, tiles) {
      tiles.forEach((tile, index) => {
        setTimeout(() => {
          tile.className = `tile ${result[index]}`;
        }, index * 100);
      });
    }

    function showMessage(text) {
      const message = document.getElementById('message');
      message.textContent = text;
      setTimeout(() => {
        message.textContent = '';
      }, 2000);
    }

    function showWinModal() {
      const modal = document.getElementById('win-modal');
      const winMessage = document.getElementById('win-message');
      const continueButton = document.getElementById('continue-button');
      const playAgainButton = document.getElementById('play-again-button');

      if (dailyMode) {
        winMessage.textContent = "Congratulations! You've completed today's daily word! Would you like to continue playing with random words?";
        continueButton.style.display = 'block';
        playAgainButton.style.display = 'none';
      } else {
        winMessage.textContent = "Congratulations! You found the word!";
        continueButton.style.display = 'none';
        playAgainButton.style.display = 'block';
      }

      modal.style.display = 'flex';
    }

    function getRandomWord() {
      return words[Math.floor(Math.random() * words.length)];
    }

    function resetGame() {
      currentRow = 0;
      currentTile = 0;
      gameOver = false;
      word = dailyMode ? getDailyWord() : getRandomWord();
      initializeBoard();
    }

    function getDailyWord() {
      const date = new Date();
      const seed = date.getFullYear() * 10000 + (date.getMonth() + 1) * 100 + date.getDate();
      const dailyIndex = seed % words.length;
      return words[dailyIndex];
    }

    document.addEventListener('click', focusInput);

    // Ensure input is focused on touch events
    document.addEventListener('touchstart', (e) => {
      focusInput();
    });

    // Prevent default zoom behavior on double tap
    document.addEventListener('dblclick', (e) => {
      e.preventDefault();
    });

    const hiddenInput = document.getElementById('hidden-input');

    // Handle input events for mobile keyboards
    hiddenInput.addEventListener('input', (e) => {
      const value = e.target.value.toUpperCase();
      if (value && /^[A-Z]$/.test(value)) {
        handleKeyPress(value);
      }
      hiddenInput.value = ''; // Clear input after handling
    });

    // Handle special keys (backspace and enter)
    hiddenInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === 'Backspace') {
        e.preventDefault();
        handleKeyPress(e.key);
      }
    });

    document.getElementById('continue-button').addEventListener('click', () => {
      dailyMode = false;
      document.getElementById('mode-text').textContent = 'Random Words';
      document.getElementById('mode-indicator').textContent = 'RANDOM';
      const modal = document.getElementById('win-modal');
      modal.style.display = 'none';
      resetGame();
    });

    document.getElementById('play-again-button').addEventListener('click', () => {
      const modal = document.getElementById('win-modal');
      modal.style.display = 'none';
      resetGame();
    });

    document.getElementById('mode-indicator').addEventListener('click', () => {
      if (!gameOver) {
        dailyMode = !dailyMode;
        document.getElementById('mode-text').textContent = dailyMode ? 'Daily Challenge' : 'Random Words';
        document.getElementById('mode-indicator').textContent = dailyMode ? 'DAILY' : 'RANDOM';
        resetGame();
      }
    });

    word = dailyMode ? getDailyWord() : getRandomWord();
    initializeBoard();
  </script>
</body>
</html>